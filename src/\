import gspread
from google.oauth2.service_account import Credentials
from iosmanage import get_archivos

scope=[
    "https://www.googleapis.com/auth/spreadsheets"
]
creds = Credentials.from_service_account_file("credentials.json",scopes=scope)
client = gspread.authorize(creds)

sheetid = "1ryDAAKKe2thiksaN_FVnVELmJ5e2NRuB9183FlRp78Q" ##desde d/ hasta / de la url de calculo 

sheettt = client.open_by_key(sheetid)

def opensheet(sheetid):
    return client.open_by_key(sheetid)


def writeinsheet(dir, sheet):
    files = get_archivos(dir)
    numrows = len(sheet.col_values(1))
    start_row = numrows + 1
    # Preparar los datos para la actualizaci√≥n
    values = []
    for arch, disk in zip(files[0], files[1]):
        values.append([arch, disk])
        print(values)
    
    
writeinsheet("~/Escritorio",sheettt.sheet1)

sheettt.sheet1.update('A1', [[1, 1,1,1,1,1,1,1,1], [3,5,6,7,8, 4]])
